<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>Advanced Test Setup - Predator</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="css/theme.css" type="text/css" />
  <link rel="stylesheet" href="css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Advanced Test Setup";
    var mkdocs_page_input_path = "tests.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="index.html" class="icon icon-home"> Predator</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="index.html">About</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="installation.html">Installation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="myfirsttest.html">My First Test</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="tests.html">Advanced Test Setup</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#data-reuse-with-variables">Data Reuse with Variables</a></li>
    

    <li class="toctree-l2"><a href="#request-reuse-with-dsl-definitions">Request Reuse with DSL Definitions</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#creating-a-dsl-definition">Creating a DSL Definition</a></li>
        
            <li><a class="toctree-l3" href="#creating-a-test-that-uses-the-dsl">Creating a Test that Uses the DSL</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="schedulesandreports.html">Schedules and Reports</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="plugins.html">Plugins</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="contributing.html">Contributing</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Predator</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
    
      
    
    <li>Advanced Test Setup</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <div class="admonition note">
<p class="admonition-title">What you should already know</p>
<p>We assume you have already familiarized yourself with the basic concepts used in Predator and that you successfully created your first test. If not, we strongly recommend you first complete the steps in the <a href="myfirsttest.html">My First Test</a> topic before proceeding with the instructions below.</p>
</div>
<h1 id="data-reuse-with-variables">Data Reuse with Variables<a class="headerlink" href="#data-reuse-with-variables" title="Permanent link">#</a></h1>
<p>The <strong>Captures</strong> field of the <a href="myfirsttest.html#http-request-properties">HTTP request properties</a> allows you to extract (capture) data from the request response and store it in a variable for reuse in another request. Use JSONPath syntax to extract the data of your choice. In the following example we extract the <code>id</code> field and store it in a <code>petId</code> variable:</p>
<p><img alt="Screenshot" src="images/extract_data_to_variable.png" /></p>
<p>You can then use <code>petId</code> in a request by placing it between double brackets, like so:</p>
<p><code>{{petId}}</code></p>
<p>Here's an example of using <code>{{petId}}</code> in the request path:</p>
<p><img alt="Screenshot" src="images/variable_in_path.png" /></p>
<h1 id="request-reuse-with-dsl-definitions">Request Reuse with DSL Definitions<a class="headerlink" href="#request-reuse-with-dsl-definitions" title="Permanent link">#</a></h1>
<p>This is the moment where Predator shows its teeth and unleashes its true power. </p>
<p>Writing a performance test that checks specific parts of your API end-to-end can be a huge hassle, but now it is effortless. By creating DSL definitions using Predator's Domain Specific Language (DSL), request templates are generated which you can then reuse in the same test and in other tests under the same DSL type, reducing replication.</p>
<p>Let's dive right in and get going with our first DSL definition. </p>
<div class="admonition note">
<p class="admonition-title">Predator API</p>
<p>This functionality is only available through the <a href="">Predator API</a>.</p>
</div>
<h2 id="creating-a-dsl-definition">Creating a DSL Definition<a class="headerlink" href="#creating-a-dsl-definition" title="Permanent link">#</a></h2>
<p>Before you can use a DSL definition, you must create it first. You do so by invoking the <a href="">Create DSL request</a>. Here's an example request body for creating a DSL definition of a GET request. Notice how we use the <code>{{petId}}</code> in the url endpoint (we will create this variable in the example of a POST request DSL definition):</p>
<pre class="codehilite"><code class="language-JSON">{
    "name": "get-pet",
    "request": {
        "get": {
            "url": "http://127.0.0.1:3000/pets/{{petId}}"
        }   
    }
}</code></pre>

<p>The request body for creating a DSL definition of a POST request is a bit more elaborate, since it requires that you pass in the entire body that makes up the POST request. The following example shows how to do this. Notice how we add a <code>capture</code> array, in which we define the <code>petId</code> variable for storing the pet ID. We can then reuse it in another request (like in the example of a GET request above).</p>
<pre class="codehilite"><code class="language-JSON">{
    "name": "create-pet",
    "request": {
        "post": {
            "url": "http://127.0.0.1:3000/pets",
            "json": {
                "name": "mickey",
                "species": "dog"
            },
            "capture": [
                {
                    "json": "$.id",
                    "as": "petId"
                }   
            ]
        }   
    }
}</code></pre>

<h2 id="creating-a-test-that-uses-the-dsl">Creating a Test that Uses the DSL<a class="headerlink" href="#creating-a-test-that-uses-the-dsl" title="Permanent link">#</a></h2>
<p>Tests that use a DSL definition can only be created using the <a href="">Create DSL Test</a> API request. The <a href="">Create DSL Test</a> API request body must include all components that make up a test, including pre-scenario requests and scenarios. However, instead of defining the entire HTTP request in each scenario step (as you would through the Predator UI), you can now reference the HTTP request through its DSL definition. You do so, using the <code>action</code> property (in the <code>steps</code> array). </p>
<p>Here's an example:</p>
<pre class="codehilite"><code class="language-JSON">{
  "name": "Pet store",
  "description": "DSL",
  "type": "dsl", // Make sure the type is set to DSL
  "before": {
    "steps": [
        {
            "action": "petstore.create-pet"
        }   
    ]
  },
  "scenarios": [
    {
        "scenario_name": "Only get pet",
        "steps": [
            {
                "action": "petstore.get-pet"
            }   
        ]
    }
  ]
}</code></pre>

<p>There are two additional items to note:</p>
<ul>
<li>
<p>The <code>type</code> must always be set to <code>dsl</code>.</p>
</li>
<li>
<p>The <code>action</code> value uses the following syntax: <code>{dsl_group_name}.{dsl_name}</code>, in which the <code>dsl_group_name</code> is the name used in the path of the <a href="">Create DSL Defintion</a> API request. </p>
</li>
</ul>
<p>If you login to the Predator UI after creating the test, you will notice that the test has been added with a type of <strong>dsl</strong>. </p>
<p><img alt="Screenshot" src="images/dsltestinui.png" /></p>
<p>You can now run the test as you would any other. </p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="schedulesandreports.html" class="btn btn-neutral float-right" title="Schedules and Reports">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="myfirsttest.html" class="btn btn-neutral" title="My First Test"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="myfirsttest.html" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="schedulesandreports.html" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>

</body>
</html>
